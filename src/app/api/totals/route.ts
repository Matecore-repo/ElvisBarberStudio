import { NextRequest, NextResponse } from "next/server"\nimport { neon } from "@neondatabase/serverless"\n\nexport async function GET(request: NextRequest) {\n  try {\n    const sql = neon(process.env.DATABASE_URL!)\n    \n    // Obtener totales del día actual\n    const totals = await sql(`\n      SELECT \n        COALESCE(SUM(CASE WHEN payment_method = "cash" THEN total_amount ELSE 0 END), 0) as cash_total,\n        COALESCE(SUM(CASE WHEN payment_method = "mp" THEN total_amount ELSE 0 END), 0) as mp_total,\n        COALESCE(SUM(total_amount), 0) as grand_total,\n        COUNT(*) as total_sales\n      FROM sales\n      WHERE DATE(date_time) = CURRENT_DATE\n    `)\n    \n    // Obtener gastos del día\n    const expenses = await sql(`\n      SELECT COALESCE(SUM(expenses_total), 0) as expenses\n      FROM cash_closings\n      WHERE date = CURRENT_DATE\n    `)\n    \n    const result = {\n      cashTotal: totals[0].cash_total,\n      mpTotal: totals[0].mp_total,\n      grandTotal: totals[0].grand_total,\n      totalSales: totals[0].total_sales,\n      expenses: expenses[0].expenses,\n      cashFinal: Number(totals[0].cash_total) - Number(expenses[0].expenses)\n    }\n    \n    return NextResponse.json(result)\n  } catch (error) {\n    console.error("Error fetching totals:", error)\n    return NextResponse.json({ error: "Error al obtener totales" }, { status: 500 })\n  }\n}
